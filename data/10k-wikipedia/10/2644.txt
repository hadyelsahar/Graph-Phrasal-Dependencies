These khanates, though often self-ruling, were vassals and subjects of the Iranian shah .
